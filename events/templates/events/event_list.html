{% extends "base.html" %}

{% load static %}
{% load crispy_forms_tags %}

{% url 'events' as events_url %}

{% block title %}Upcoming Events | Runners Hive{% endblock %}

{% block content %}

<!-- Upcoming Events Section -->
<section id="upcoming-events" aria-labelledby="upcoming-events-title" class="container my-4">
    <h1 id="upcoming-events-title" class="mb-4 text-center">Upcoming Events</h1>
    <p class="mb-4 text-center lead">
        Browse upcoming events and join our local running communities!
    </p>

    <!-- Filter Form -->
     
    <!-- Toggle Button for Collapsible Filters -->
    <!-- See: https://getbootstrap.com/docs/5.0/components/collapse/ -->
    <button id="filterToggleBtn" class="btn btn-dark-big-outline mb-3" type="button" data-bs-toggle="collapse" data-bs-target="#eventFilters"
            aria-expanded="false" aria-controls="eventFilters">
        Filter Events â–¾
    </button>

    <!-- Collapsible Filter Area -->
    <div class="collapse" id="eventFilters">
        <form method="get" class="mb-4 event-filter-form" aria-label="Event filter form">

            <div class="filter-group">
                {{ form.category|as_crispy_field }}
            </div>
            <div class="filter-group">
                {{ form.difficulty|as_crispy_field }}
            </div>
            <div class="filter-group">
                {{ form.date_filter|as_crispy_field }}
            </div>
            <div class="filter-group inline-boolean">
                {{ form.cancelled|as_crispy_field }}
            </div>

            <div class="filter-actions">
                <button type="submit" class="btn btn-dark-big mt-2">Apply Filters</button>
                <a href="{% url 'events' %}" class="btn btn-light-big mt-2">Reset Filters</a>
            </div>
        </form>
    </div>

    <!-- Events List -->
    {% if events %}
        <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
            {% for event in events %}
                {% include "events/_event_card.html" %}
            {% endfor %}
        </div>

        {% if is_paginated %}
            {% include "events/_page_navigation.html" %}
        {% endif %}

    <!-- No Events Message -->
    {% else %}
        <p class="text-center lead" role="status">No upcoming events found :(</p>
    {% endif %}
</section>

{% endblock %}

{% block extras %}
<script src="{% static 'js/toggle_filters.js' %}"></script>
{% endblock %}
